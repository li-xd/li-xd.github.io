---
layout: post
title: "PHP.Yield"
author: "XiaoDong.Li"
---

1. 生成器

    * 提供简单的对象迭代, 相比定义类是实现 Iterator 接口方式,性能开销和复杂性大大降低.
    * 当一个生成器被调用的时候, 他返回一个可以被遍历的对象. 当你遍历这个对象的时候, PHP将会在每次需要值的时候调用生成器函数,并在产生一个值之后保存生成器的状态,这样它就可以在需要产生下一个值的时候恢复调用状态.
    * 一旦不再需要产生更多的值, 生成器函数可以简单退出, 而调用生成器的代码还可以继续执行, 就像一个数组已经被遍历完了.
1. 生成器语法

    * 一个生成器不可以返回值:这样做会产生一个编译错误. 然而 return 空是一个有效的语法并且它将会终止生成器继续执行.
    * yield 关键字 
        * 生成器函数的核心是 yield 关键字.
        * 形式上像一个 return 申明, return 会返回并中止函数的执行
        * yield 会返回一个值给循环调用此生成器的代码并且只是暂停执行生成器函数.
    * 指定键名来生成值 
        * yield $id => $fields;
    * 使用引用来生成值 
        * 通过在函数名前面加上一个引用符号.

1. 生成器对象

    大部分 `Generator` 类中的方法拥有和 `Iterator` 接口一样的语义，但是生成器对象有一个特殊的方法： `send()`.

    ```php
    class Generator implements Interator {
         public function rewind(); // 返回到迭代器的第一个元素 
         public function valid(); // 返回 false 如果迭代器已经关闭， 否则返回 true 
         public function current(); // 返回当前 yield 值 
         public function key(); // 返回当前 yield 键名 
         public function next(); // 恢复生成器的执行 
         public function send($value); // 将传入的值作为 yeild 表达式的结果并且恢复发生器的执行 
    }
    ```
    